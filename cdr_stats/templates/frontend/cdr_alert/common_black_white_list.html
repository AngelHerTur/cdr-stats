{% extends "frontend/master.html" %}
{% load i18n common_tags dajaxice_templatetags %}

{% block title %}{% trans "Black & white country prefix list" %}{% endblock %}

{% block extra_head %}
    {% dajaxice_js_import %}
    <script src="{{ STATIC_URL }}cdr-stats/js/jquery.dajax.core.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}cdr-stats/js/jquery.ba-serializeobject.js" type="text/javascript"></script>
    <script type="text/javascript">

        // To sort question
        function add_bl_country(country_id) {
            Dajaxice.cdr_alert.add_blacklist(Dajax.process, {'country_id': country_id});
        }

        $(function() {
            $('#id_bl_country').submit(function(e) {

                var currentForm = this;
                e.preventDefault();
                var country_id = $('#id_bl_country :selected').val();
                add_bl_country(country_id);
            });
        });


    </script>

    {% include "frontend/custom_jquery_select_all.html" %}
    <h3>{% trans "black & white list"|title %} <small>{% trans "list of country prefixies" %}</small></h3>
{% endblock %}

{% block content %}
<script type="text/javascript">
    function add_button()
    {
        window.location = 'add/';
    }

    function delete_button()
    {
        $('#ListForm').submit();
    }
</script>

<div id="id_alert_success"></div>

<!--<div class="span12">
    <div class="row">
        <div class="btn-group">
            <button class="btn">{% trans "Action" %}</button>
            <button class="btn dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                {% if perms.cdr_alert.delete_alarm %}
                    <li><a href="#" onclick="delete_button()">{% trans "Delete selected" %}</a></li>
                {% endif %}
            </ul>
        </div>
        {% if perms.cdr_alert.add_alarm %}
            <a class="btn btn-info" href="#" onclick="add_button()">{% trans "Add" %}</a>
        {% endif %}
    </div>
</div>
<br/><br/>-->
<div class="row">
    <div class="span12">
        <center>
            <h3>{% trans "blacklist"|title %}</h3>
        </center>
        <table class="table table-striped table-bordered table-condensed">
            {% for row in blacklist|groupby_columns:3 %}
                <tr>
                    {% for obj in row %}
                        <td>{{ obj.phonenumber_prefix }} | {{ obj.country.countryname }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>
</div>

<div class="row">
    <div class="span12">
        <form action="." id="id_bl_country" method="post" enctype="multipart/form-data">
            {% for field in bl_country_form %}
            <div class="row{% if field.errors %} control-group error{% endif %}">
                <div class="span5">
                    {{ field }}&nbsp;<input id="add_bl_country" type="submit" class="btn btn-primary" value="{% trans "Black list this country" %}" />
                </div>
            </div>
            {% endfor %}
        </form>
    </div>
</div>

<div class="row">
    <div class="span12">
        <center>
            <h3>{% trans "whitelist"|title %}</h3>
        </center>
        <table class="table table-striped table-bordered table-condensed">
            {% for row in whitelist|groupby_columns:5 %}
                <tr>
                    {% for obj in row %}
                        <td>{{ obj.phonenumber_prefix }} | {{ obj.country.countryname }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>
</div>
{% endblock %}
