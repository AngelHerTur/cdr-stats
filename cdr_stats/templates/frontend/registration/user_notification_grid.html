{% load i18n common_tags pagination_tags cdr_extras icons %}

{% if msg_note %}
    <div class="alert alert-success">
        <strong>{% trans "Alert" %} : </strong>  {{ msg_note }}
    </div>
{% endif %}

<div class="btn-group">
    <button class="btn btn-small">Action</button>
    <button class="btn btn-small dropdown-toggle" data-toggle="dropdown">
        <span class="caret"></span>
    </button>
    <ul class="dropdown-menu">
        <li><a href="#" onclick="mark_read_all_button()">{% trans "Mark all as read" %}</a></li>
        <li><a href="#" onclick="make_read_button()">{% trans "Mark as read" %}</a></li>
        <li><a href="#" onclick="delete_button()">{% trans "Delete notifications" %}</a></li>
    </ul>
</div>

<br/><br/>

<form method="POST" action="del/0/" enctype="multipart/form-data" id="ListForm">
    {% csrf_token %}

    <input type="hidden" name="action" value="tabs-3" />
    <input type="hidden" name="form-type" value="notification_list" />

    <table class="table table-striped table-bordered table-condensed">
        <thead>
        <tr>
            <th><input type="checkbox" onclick="toggleChecked(this.checked)"></th>
            <th>{% sort_link "Message" col_name_with_order.message %}</th>
            <th>{% sort_link "Notice type" col_name_with_order.notice_type %}</th>
            <th>{% sort_link "Sender" col_name_with_order.sender %}</th>
            <th>{% sort_link "Date" col_name_with_order.added %}</th>
            <th>{% trans "Action" %}</th>
        </tr>
        </thead>
        {% if user_notification %}
            {% autopaginate user_notification PAGE_SIZE %}
            {% for row in user_notification %}
                <tr>
                    <td><input type="checkbox" name="select" class="checkbox" value="{{ row.id }}" /></td>
                    <td>{{ row.message }}</td>
                    <td>{{ row.notice_type }}</td>
                    <td>{{ row.sender }}</td>
                    <td>{{ row.added }}</td>
                    <td>
                        <a href="../update_notice_status_cust/{{ row.id }}/">
                            <span class="label label-info">{{ row.unseen|seen_unseen_word }}</span>
                        </a>
                    </td>
                </tr>
            {% endfor %}
            <tr>
                <td colspan="9">
                    {% paginate %}
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="8" align="center">
                    {% trans "no records found"|title %}
                </td>
            </tr>
        {% endif %}
    </table>
</form>
<script type="text/javascript">
    function make_read_button()
    {
        $('<input>').attr({
            type: 'hidden',
            id: 'id_mark_read',
            name: 'mark_read',
            value: 'true',
        }).appendTo('#ListForm');

        $('#ListForm').submit();
    }
    function delete_button()
    {
        $('<input>').attr({
            type: 'hidden',
            id: 'id_mark_read',
            name: 'mark_read',
            value: 'false',
        }).appendTo('#ListForm');

        $('#ListForm').submit();
    }
    function mark_read_all_button()
    {
        window.location.replace("/user_detail_change/?action=tabs-3&notification=mark_read_all");
    }
</script>
