{% extends "cdr/master.html" %}
{% load i18n %}

{% load cdr_extras %}
{% load uni_form_tags %}

{% block extra_header %}
    {% include "cdr/visualize_header.html" %}
{% endblock %}
 
{% block content %}
<div class="search-form">
{% with form.helper as helper %}
    {% uni_form form helper %}
{% endwith %}
</div>

<br/><br/>

<script language="javascript" type="text/javascript">
$(function () {

    var data = [
    {% for call in total_record %}
        {% if call.0 %}
            { label: '{{ call.0|month_name:call.1 }} {{ call.2|time_in_min:"min"}}', data: {{ call.2 }} },
        {% endif %}
    {% endfor %}
    ];

    var options = 
    {
        series: {
            pie: { 
                show: true,
                radius: 1,
                label: {
                    show: true,
                    radius: 3/4,
                    formatter: function(label, series){
                        return '<div style="font-size:12pt;text-align:center;padding:2px;color:white;">'+Math.round(series.percent)+'%</div>';
                    },
                    background: { opacity: 0.5 }
                }
            }
        },
        legend: {
              show: true,
            position: "se",
            margin: [-310,50]
        },
        grid:{
            borderWidth: 0,
            hoverable: true,
        }
    }

    $.plot($("#placeholder"), data, options);
});
</script>

<center>
   <h1>{% blocktrans %}Traffic Last {{comp_months}} Months{% endblocktrans %}</h1>
    <div id="placeholder" style="width:700px;height:300px"></div>
</center>

{% endblock %}
